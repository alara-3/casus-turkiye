<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Casus - TÃ¼rkiye Edisyonu</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

:root {
  --bg: #0a0a0f;
  --card: #151520;
  --card-border: #252535;
  --accent: #ff3b5c;
  --accent-glow: rgba(255, 59, 92, 0.3);
  --green: #34d399;
  --yellow: #fbbf24;
  --blue: #60a5fa;
  --text: #f0f0f5;
  --text-dim: #6b6b80;
  --radius: 16px;
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100dvh;
  overflow-x: hidden;
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom);
}

.screen { display: none; min-height: 100dvh; padding: 20px; flex-direction: column; }
.screen.active { display: flex; }

.header { text-align: center; padding: 20px 0 10px; }
.header h1 { font-size: 28px; font-weight: 800; letter-spacing: -0.5px; }
.header h1 span { color: var(--accent); }
.header p { color: var(--text-dim); font-size: 14px; margin-top: 4px; }

.btn {
  display: flex; align-items: center; justify-content: center; gap: 8px;
  width: 100%; padding: 16px; border: none; border-radius: var(--radius);
  font-size: 17px; font-weight: 600; cursor: pointer;
  transition: transform 0.15s, opacity 0.15s;
  font-family: inherit;
}
.btn:active { transform: scale(0.97); opacity: 0.9; }
.btn-primary { background: var(--accent); color: white; }
.btn-secondary { background: var(--card); color: var(--text); border: 1px solid var(--card-border); }
.btn-small { padding: 10px 16px; font-size: 14px; width: auto; border-radius: 10px; }
.btn-ghost { background: transparent; color: var(--text-dim); padding: 10px; font-size: 14px; }

.player-section { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 24px; }
.player-counter { display: flex; align-items: center; gap: 24px; }
.player-counter .num {
  font-size: 72px; font-weight: 800; min-width: 80px; text-align: center;
  background: linear-gradient(135deg, var(--accent), #ff6b8a);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.counter-btn {
  width: 52px; height: 52px; border-radius: 50%; border: 2px solid var(--card-border);
  background: var(--card); color: var(--text); font-size: 24px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-family: inherit; transition: transform 0.15s;
}
.counter-btn:active { transform: scale(0.9); }

.spy-counter { display: flex; align-items: center; gap: 16px; }
.spy-counter .num { font-size: 36px; font-weight: 700; min-width: 40px; text-align: center; color: var(--accent); }
.spy-counter .counter-btn { width: 40px; height: 40px; font-size: 18px; }

.categories-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
  padding: 10px 0; flex: 1; align-content: start;
}
.cat-card {
  background: var(--card); border: 2px solid var(--card-border); border-radius: var(--radius);
  padding: 14px; cursor: pointer; transition: all 0.2s; text-align: center;
}
.cat-card.selected { border-color: var(--accent); background: rgba(255, 59, 92, 0.1); }
.cat-card .emoji { font-size: 28px; margin-bottom: 6px; }
.cat-card .name { font-size: 13px; font-weight: 600; }
.cat-card .count { font-size: 11px; color: var(--text-dim); margin-top: 2px; }

.select-actions { display: flex; gap: 10px; padding: 10px 0; }

.reveal-area {
  flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 16px; text-align: center;
}
.role-card {
  width: 100%; max-width: 320px; border-radius: 20px; padding: 40px 24px;
  position: relative; overflow: hidden;
}
.role-card.spy-card {
  background: linear-gradient(135deg, #1a0008, #2d0015, #1a0008);
  border: 2px solid var(--accent);
  box-shadow: 0 0 40px var(--accent-glow);
}
.role-card.normal-card {
  background: linear-gradient(135deg, #0a1628, #0f1f3d, #0a1628);
  border: 2px solid var(--blue);
  box-shadow: 0 0 40px rgba(96, 165, 250, 0.2);
}
.role-card .role-icon { font-size: 56px; margin-bottom: 12px; }
.role-card .role-title { font-size: 14px; font-weight: 600; color: var(--text-dim); text-transform: uppercase; letter-spacing: 2px; }
.role-card .role-value { font-size: 26px; font-weight: 800; margin-top: 8px; }
.role-card .role-sub { font-size: 15px; color: var(--text-dim); margin-top: 8px; }

.role-hidden {
  width: 100%; max-width: 320px; border-radius: 20px; padding: 60px 24px;
  background: var(--card); border: 2px dashed var(--card-border);
  text-align: center; cursor: pointer;
}
.role-hidden .tap-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.5; }
.role-hidden p { color: var(--text-dim); font-size: 15px; }
.role-hidden .player-num { font-size: 22px; font-weight: 700; color: var(--text); margin-bottom: 8px; }

.progress-bar { width: 100%; max-width: 320px; height: 4px; background: var(--card); border-radius: 2px; overflow: hidden; }
.progress-bar .fill { height: 100%; background: var(--accent); transition: width 0.3s; border-radius: 2px; }

.timer-section { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 20px; }
.timer-display {
  font-size: 80px; font-weight: 800; font-variant-numeric: tabular-nums;
  background: linear-gradient(135deg, var(--text), #a0a0b0);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.timer-display.warning { background: linear-gradient(135deg, var(--yellow), #f59e0b); -webkit-background-clip: text; }
.timer-display.danger { background: linear-gradient(135deg, var(--accent), #ff6b8a); -webkit-background-clip: text; }
.timer-controls { display: flex; gap: 12px; }
.timer-presets { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; }
.timer-presets .btn-small { min-width: 60px; }
.timer-presets .btn-small.active { background: var(--accent); color: white; border-color: var(--accent); }

.location-hint { background: var(--card); border-radius: var(--radius); padding: 16px; text-align: center; width: 100%; max-width: 320px; }
.location-hint .label { font-size: 12px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px; }
.location-hint .value { font-size: 18px; font-weight: 700; margin-top: 4px; }

.bottom-actions { padding: 16px 0; display: flex; flex-direction: column; gap: 10px; }
.bottom-actions-row { display: flex; gap: 10px; }
.bottom-actions-row .btn { flex: 1; }

.rules-content { flex: 1; overflow-y: auto; padding: 16px 0; }
.rules-content h3 { font-size: 17px; margin: 16px 0 8px; color: var(--accent); }
.rules-content h3:first-child { margin-top: 0; }
.rules-content p, .rules-content li { font-size: 15px; line-height: 1.6; color: var(--text-dim); }
.rules-content ul { padding-left: 20px; }
.rules-content li { margin-bottom: 6px; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.fade-in { animation: fadeIn 0.3s ease; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
.pulse { animation: pulse 1.5s ease infinite; }

.location-list-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 10px 0; }
.location-list-grid .loc-item {
  background: var(--card); border-radius: 10px; padding: 10px;
  font-size: 13px; text-align: center; border: 1px solid var(--card-border);
}
.location-list-grid .cat-label {
  grid-column: 1 / -1; font-size: 12px; color: var(--accent);
  font-weight: 700; text-transform: uppercase; letter-spacing: 1px;
  padding: 8px 0 2px;
}
</style>
</head>
<body>

<div id="home" class="screen active">
  <div class="header">
    <h1>ğŸ•µï¸ <span>Casus</span></h1>
    <p>TÃ¼rkiye Edisyonu</p>
  </div>
  <div class="player-section">
    <div>
      <p style="text-align:center;color:var(--text-dim);font-size:13px;margin-bottom:8px;">Oyuncu SayÄ±sÄ±</p>
      <div class="player-counter">
        <button class="counter-btn" onclick="changePlayerCount(-1)">âˆ’</button>
        <div class="num" id="playerCount">4</div>
        <button class="counter-btn" onclick="changePlayerCount(1)">+</button>
      </div>
    </div>
    <div>
      <p style="text-align:center;color:var(--text-dim);font-size:13px;margin-bottom:8px;">Casus SayÄ±sÄ±</p>
      <div class="spy-counter">
        <button class="counter-btn" onclick="changeSpyCount(-1)">âˆ’</button>
        <div class="num" id="spyCount">1</div>
        <button class="counter-btn" onclick="changeSpyCount(1)">+</button>
      </div>
    </div>
  </div>
  <div class="bottom-actions">
    <button class="btn btn-primary" onclick="goToCategories()">Kategorileri SeÃ§</button>
    <div class="bottom-actions-row">
      <button class="btn btn-secondary" onclick="showRules()">NasÄ±l OynanÄ±r?</button>
      <button class="btn btn-secondary" onclick="quickStart()">HÄ±zlÄ± BaÅŸla</button>
    </div>
  </div>
</div>

<div id="categories" class="screen">
  <div class="header">
    <h1>Kategoriler</h1>
    <p>Oynamak istediÄŸin kategorileri seÃ§</p>
  </div>
  <div class="select-actions">
    <button class="btn btn-small btn-secondary" onclick="selectAllCats()">Hepsini SeÃ§</button>
    <button class="btn btn-small btn-secondary" onclick="deselectAllCats()">Temizle</button>
  </div>
  <div class="categories-grid" id="catGrid"></div>
  <div class="bottom-actions">
    <button class="btn btn-primary" onclick="startGame()">Oyunu BaÅŸlat</button>
    <button class="btn btn-ghost" onclick="showScreen('home')">â† Geri</button>
  </div>
</div>

<div id="reveal" class="screen">
  <div class="header">
    <h1>KartlarÄ± DaÄŸÄ±t</h1>
    <p id="revealSub">Telefonu sÄ±rayla herkese ver</p>
  </div>
  <div class="reveal-area" id="revealArea"></div>
  <div class="bottom-actions">
    <button class="btn btn-ghost" onclick="showScreen('home')">Oyunu Bitir</button>
  </div>
</div>

<div id="timer" class="screen">
  <div class="timer-section">
    <div class="location-hint" id="locationHint">
      <div class="label">Mekan / KiÅŸi</div>
      <div class="value" id="locationDisplay">â€”</div>
    </div>
    <div class="timer-display" id="timerDisplay">08:00</div>
    <div class="timer-presets" id="timerPresets">
      <button class="btn btn-small btn-secondary" onclick="setTimer(300)">5dk</button>
      <button class="btn btn-small btn-secondary active" onclick="setTimer(480)">8dk</button>
      <button class="btn btn-small btn-secondary" onclick="setTimer(600)">10dk</button>
    </div>
    <div class="timer-controls">
      <button class="btn btn-small btn-primary" id="timerToggle" onclick="toggleTimer()">BaÅŸlat</button>
      <button class="btn btn-small btn-secondary" onclick="resetTimer()">SÄ±fÄ±rla</button>
    </div>
  </div>
  <div class="bottom-actions">
    <button class="btn btn-secondary" onclick="showLocations()">Mekan Listesi</button>
    <button class="btn btn-ghost" onclick="showScreen('home')">Ana MenÃ¼</button>
  </div>
</div>

<div id="rules" class="screen">
  <div class="header"><h1>NasÄ±l OynanÄ±r?</h1></div>
  <div class="rules-content">
    <h3>Oyunun AmacÄ±</h3>
    <p>Herkese bir mekan/kiÅŸi kartÄ± daÄŸÄ±tÄ±lÄ±r. Bir (veya daha fazla) kiÅŸi <strong>Casus</strong> olarak atanÄ±r ve mekanÄ±/kiÅŸiyi bilmez. Casus mekanÄ± bulmaya, diÄŸerleri casusu bulmaya Ã§alÄ±ÅŸÄ±r.</p>
    <h3>Oyun AkÄ±ÅŸÄ±</h3>
    <ul>
      <li>Telefon sÄ±rayla elden ele geÃ§er, herkes kartÄ±na bakar</li>
      <li>SÄ±rayla birbirinize sorular sorun (Ã¶rn: "Orada ne yaparsÄ±n?", "Bu kiÅŸiyi nasÄ±l tanÄ±mlarsÄ±n?")</li>
      <li>Cevaplar kÄ±sa ve belirsiz olabilir ama Ã§ok kaÃ§amak olursan ÅŸÃ¼phe Ã§ekersin!</li>
      <li>SÃ¼re bitince veya biri "OYLAMA!" dediÄŸinde herkes casusu tahmin eder</li>
    </ul>
    <h3>Kazanma</h3>
    <ul>
      <li><strong>Casus kazanÄ±r:</strong> MekanÄ±/kiÅŸiyi doÄŸru tahmin ederse VEYA oylamada yakalanmazsa</li>
      <li><strong>DiÄŸerleri kazanÄ±r:</strong> Oylamada casusu bulurlarsa</li>
    </ul>
    <h3>Ä°puÃ§larÄ±</h3>
    <ul>
      <li>SorularÄ±nÄ±z Ã§ok aÃ§Ä±k olmasÄ±n - casusu deÄŸil ama casusa ipucu verirsin!</li>
      <li>CevaplarÄ±n Ã§ok belirsiz olmasÄ± da ÅŸÃ¼phe Ã§eker</li>
      <li>Casus: SorularÄ± iyi dinle, cevaplardan Ã§Ä±karÄ±m yap</li>
    </ul>
  </div>
  <div class="bottom-actions">
    <button class="btn btn-primary" onclick="showScreen('home')">Tamam</button>
  </div>
</div>

<div id="locations" class="screen">
  <div class="header">
    <h1>Mekan Listesi</h1>
    <p>Bu turda olasÄ± mekanlar</p>
  </div>
  <div class="location-list-grid" id="locationListGrid" style="flex:1;overflow-y:auto;"></div>
  <div class="bottom-actions">
    <button class="btn btn-primary" onclick="showScreen('timer')">Geri</button>
  </div>
</div>

<script>
const DATA = {
  "gunluk": {
    name: "GÃ¼nlÃ¼k Hayat", emoji: "ğŸ ",
    locations: [
      "Askere uÄŸurlama otobÃ¼sÃ¼", "SÃ¼nnet dÃ¼ÄŸÃ¼nÃ¼", "KÄ±na gecesi",
      "Apartman yÃ¶netim toplantÄ±sÄ±", "Site WhatsApp grubu kavgasÄ±",
      "Bayramda akraba turu arabasÄ±", "NÃ¼fus mÃ¼dÃ¼rlÃ¼ÄŸÃ¼ kuyruÄŸu",
      "MuhtarlÄ±k", "DÃ¼ÄŸÃ¼nde halay baÅŸÄ±", "Cenaze evi taziye Ã§adÄ±rÄ±",
      "Cami avlusu bayram namazÄ± Ã§Ä±kÄ±ÅŸÄ±", "Kurban kesim yeri",
      "Sokak dÃ¼ÄŸÃ¼nÃ¼ (yol kapatÄ±lmÄ±ÅŸ)", "NiÅŸan bozma toplantÄ±sÄ±",
      "EmlakÃ§Ä±da pazarlÄ±k", "Oto galeri (ikinci el)",
      "Esnaf lokantasÄ± Ã¶ÄŸle arasÄ±", "KapÄ±cÄ± dairesi",
      "Mahalle bakkalÄ± (veresiye defteri olan)", "Yol kenarÄ± radar noktasÄ±",
      "Devlet hastanesi acil bekleme", "ÅehirlerarasÄ± otobÃ¼s molasÄ±",
      "Otogar", "Piknik alanÄ± mangal savaÅŸÄ±",
      "AVM food court", "Pazar yeri (semt pazarÄ±)",
      "Yaz okulu (zorla gÃ¶nderilen)", "NÃ¶betÃ§i eczane kuyruÄŸu",
      "Ehliyet sÄ±navÄ±", "Askerlik ÅŸubesi",
      "KomÅŸuya ÅŸeker-tuz istemeye gitme", "CamcÄ± dÃ¼kkanÄ±",
      "GurbetÃ§i akrabanÄ±n yaz ziyareti", "Apartman Ã§amaÅŸÄ±rhane sÄ±rasÄ±",
      "Anne-baba ile araba yolculuÄŸu", "Akraba Ã§ocuÄŸuna Ã¶dev yaptÄ±rma"
    ],
    roles: ["Damat", "Gelin", "KayÄ±nvalide", "Muhtar", "KomÅŸu", "EmlakÃ§Ä±", "ÅofÃ¶r", "MÃ¼dÃ¼r", "Memur", "Abla", "Amca", "DayÄ±"]
  },
  "yeme": {
    name: "Yeme Ä°Ã§me", emoji: "ğŸ–",
    locations: [
      "BalÄ±k ekmek tezgahÄ±", "KokoreÃ§Ã§i", "Iskender kebapÃ§Ä±sÄ±",
      "Ã‡iÄŸ kÃ¶fteci", "Meyhane (fasÄ±l gecesi)", "BÃ¼fe (tost-ayran)",
      "Tantuni tezgahÄ±", "Kumpirci", "Midyeci",
      "Seyyar kestaneci", "Gece 3'te aÃ§Ä±k bÃ¶rekÃ§i",
      "DÃ¼ÄŸÃ¼n yemeÄŸi servisi (koca kazan)", "Ramazan iftar Ã§adÄ±rÄ±",
      "CiÄŸerci (sabah 6)", "Yol kenarÄ± gÃ¶zlemeci",
      "KÃ¶y kahvaltÄ±sÄ± sofrasÄ±", "Nargile kafesi",
      "Simit arabasÄ±", "Muhallebici",
      "AskÄ±da ekmek fÄ±rÄ±nÄ±", "DÃ¶nerci (gece vardiyasÄ±)",
      "Lahmacuncu", "Pideci", "Seyyar mÄ±sÄ±rcÄ±",
      "TatlÄ±cÄ± (kÃ¼nefe sÄ±rasÄ±)", "Mahallenin Ã§orbacÄ±sÄ±",
      "Yol kenarÄ± karpuz tezgahÄ±", "KÃ¶fteci (Ä±zgara duman)",
      "MantiÄ±cÄ±", "Yemek sipariÅŸi tartÄ±ÅŸmasÄ± (ne yiyelim)"
    ],
    roles: ["AÅŸÃ§Ä±baÅŸÄ±", "Garson", "BulaÅŸÄ±kÃ§Ä±", "Patron", "MÃ¼davim", "Ã‡Ä±rak", "Kurye", "Tezgahtar", "Kasap", "FÄ±rÄ±ncÄ±"]
  },
  "cay": {
    name: "Ã‡ay & Kahve KÃ¼ltÃ¼rÃ¼", emoji: "â˜•",
    locations: [
      "Ã‡ay bahÃ§esi (emekliler masasÄ±)", "Kahvehane (okey masasÄ±)",
      "Kahvehane (tavla turnuvasÄ±)", "KÄ±raathane",
      "Ã‡ay ocaÄŸÄ± (devlet dairesi)", "Nargile kafesi",
      "TÃ¼rk kahvesi falÄ± bakÄ±lan ev", "Ã‡aycÄ±nÄ±n motoru (ofis Ã§ay servisi)",
      "Piknik mangal yanÄ± Ã§ay demliÄŸi", "Sahil Ã§ay bahÃ§esi",
      "Camii Ã¶nÃ¼ Ã§ay sohbeti", "EsnafÄ±n Ã§ay molasÄ±"
    ],
    roles: ["Ã‡aycÄ±", "Emekli amca", "Tavla oynayan", "FalcÄ±", "Okeyciler", "Patron", "Garson"]
  },
  "okul": {
    name: "Okul & Ãœniversite", emoji: "ğŸ“š",
    locations: [
      "Kantin (simit-ayran kuyruÄŸu)", "TeneffÃ¼ste koridor",
      "MÃ¼dÃ¼rÃ¼n odasÄ±", "Beden eÄŸitimi sahasÄ±", "Fen laboratuvarÄ±",
      "SÄ±nav salonu (kopya anÄ±)", "Mezuniyet tÃ¶reni",
      "Ãœniversite yemekhane", "KYK yurdu odasÄ±",
      "KÃ¼tÃ¼phane (sÄ±nav haftasÄ±)", "KampÃ¼s Ã§imleri",
      "Ã–ÄŸrenci kulÃ¼bÃ¼ standÄ±", "Ãœniversite kafeteryasÄ±",
      "Hoca odasÄ± (vize notlarÄ±)", "Dershane (YKS hazÄ±rlÄ±k)",
      "Okul servisi (sabah uykusu)", "Karne gÃ¼nÃ¼",
      "Veli toplantÄ±sÄ±", "Yurtta gece sohbeti",
      "Ã–dev teslim gÃ¼nÃ¼ (son gece panik)", "Staj baÅŸvurusu kuyruÄŸu"
    ],
    roles: ["MÃ¼dÃ¼r", "Hoca", "Ã–ÄŸrenci", "Kantinci", "Hademe", "Rehber Ã¶ÄŸretmen", "Asistan", "SÄ±nÄ±f baÅŸkanÄ±"]
  },
  "askeriye": {
    name: "Askeriye", emoji: "ğŸª–",
    locations: [
      "KÄ±ÅŸla (sabah yoklamasÄ±)", "NÃ¶bet kulÃ¼besi",
      "Asker ocaÄŸÄ± (yemek sÄ±rasÄ±)", "EÄŸitim alanÄ± (sÃ¼rÃ¼nme parkuru)",
      "Terhis gÃ¼nÃ¼ kapÄ± Ã¶nÃ¼", "Askerlik ÅŸubesi kuyruÄŸu",
      "Bedelli askerlik kayÄ±t", "KoÄŸuÅŸ (gece nÃ¶bet deÄŸiÅŸimi)",
      "Askere mektup yazma masasÄ±", "Ä°zin gÃ¼nÃ¼ otobÃ¼s terminali",
      "Yemin tÃ¶reni (aile tribÃ¼nÃ¼)", "KÄ±ÅŸla kantini"
    ],
    roles: ["Er", "Ã‡avuÅŸ", "Komutan", "NÃ¶betÃ§i", "AÅŸÃ§Ä±", "SaÄŸlÄ±kÃ§Ä±", "TerhisÃ§i", "Acemi"]
  },
  "dugun": {
    name: "DÃ¼ÄŸÃ¼n & NiÅŸan", emoji: "ğŸ’",
    locations: [
      "KÄ±na gecesi (gÃ¶bek atma)", "DÃ¼ÄŸÃ¼n salonu (sahne Ã¶nÃ¼)",
      "Gelin arabasÄ± (konvoy)", "Damat tÄ±raÅŸÄ± (berber)",
      "NiÅŸan masasÄ± (sÃ¶z kesme)", "TakÄ± tÃ¶reni (altÄ±n sayma)",
      "DÃ¼ÄŸÃ¼n fotoÄŸraf Ã§ekimi", "Gelin kapÄ±sÄ± (bahÅŸiÅŸ pazarlÄ±ÄŸÄ±)",
      "DÃ¼ÄŸÃ¼n davetiyesi daÄŸÄ±tma", "Nikah masasÄ± (belediye)",
      "DÃ¼ÄŸÃ¼n organizatÃ¶rÃ¼ ofisi", "Gelinlik maÄŸazasÄ±",
      "DÃ¼ÄŸÃ¼n sonrasÄ± temizlik", "TakÄ± sayma odasÄ±",
      "KÄ±z isteme Ã§ay servisi"
    ],
    roles: ["Damat", "Gelin", "KayÄ±nvalide", "SaÄŸdÄ±Ã§", "DJ", "Kameraman", "OrganizatÃ¶r", "HalaybaÅŸÄ±", "TakÄ± takan teyze"]
  },
  "tv": {
    name: "TV & Medya", emoji: "ğŸ“º",
    locations: [
      "Survivor eleme konseyi", "Masterchef mutfaÄŸÄ±",
      "Ã‡arkÄ±felek stÃ¼dyosu", "Magazin programÄ± canlÄ± yayÄ±n",
      "Dizi seti (mahalle sahnesi)", "Yetenek Sizsiniz jÃ¼ri masasÄ±",
      "Sabah programÄ± (canlÄ± baÄŸlantÄ±)", "Haber stÃ¼dyosu (son dakika)",
      "YarÄ±ÅŸma programÄ± finali", "O Ses TÃ¼rkiye koltuklarÄ±",
      "Kurtlar Vadisi seti", "Survivor ada konseyi",
      "Evlilik programÄ± (tanÄ±ÅŸma)", "MÃ¼ge AnlÄ± canlÄ± yayÄ±n"
    ],
    roles: ["Sunucu", "YarÄ±ÅŸmacÄ±", "JÃ¼ri Ã¼yesi", "Kameraman", "YapÄ±mcÄ±", "Spikerci", "YÃ¶netmen", "Senarist"]
  },
  "unluer": {
    name: "ÃœnlÃ¼ler (Meme Tier)", emoji: "â­",
    locations: [
      "Serdar OrtaÃ§", "BÃ¼lent Ersoy", "Ä°brahim TatlÄ±ses",
      "Kemal Sunal", "CÃ¼neyt ArkÄ±n", "MÃ¼slÃ¼m GÃ¼rses",
      "Cem YÄ±lmaz", "Åahan GÃ¶kbakar", "Adile NaÅŸit",
      "Zeki MÃ¼ren", "BarÄ±ÅŸ ManÃ§o", "Ajda Pekkan",
      "Canan Karatay", "Nusret", "CZN Burak",
      "Acun IlÄ±calÄ±", "Hadise", "HÃ¼lya AvÅŸar",
      "Demet AkalÄ±n", "Aleyna Tilki", "Tarkan",
      "Fatih Terim", "Arda Turan", "RÄ±dvan Dilmen",
      "YÄ±lmaz ErdoÄŸan", "Åener Åen", "Ezhel",
      "Reynmen", "Danilo Zanna", "Recep Tayyip (taklitÃ§isi)",
      "Cedi Osman", "Killa Hakan", "Sagopa Kajmer"
    ],
    roles: ["Menajeri", "Eski eÅŸi", "Muhasebecisi", "ÅofÃ¶rÃ¼", "KuafÃ¶rÃ¼", "Ä°cra memuru", "HayranÄ±", "Paparazzici", "KomÅŸusu"]
  },
  "spor": {
    name: "Spor", emoji: "âš½",
    locations: [
      "HalÄ± saha (PerÅŸembe akÅŸamÄ±)", "Spor salonu (fitness)",
      "Mahalle basketbol sahasÄ±", "YaÄŸlÄ± gÃ¼reÅŸ Ã§adÄ±rÄ±",
      "Milli maÃ§ yayÄ±nÄ± (kahvehane)", "Derbi gÃ¼nÃ¼ ev partisi",
      "MaÃ§ bileti kuyruÄŸu", "Stadyum tribÃ¼nÃ¼ (tezahÃ¼rat)",
      "Forma satÄ±ÅŸ dÃ¼kkanÄ±", "Futbol maÃ§Ä± sonrasÄ± kavga",
      "KoÅŸu parkuru (sabah 6)", "YÃ¼zme havuzu (yaz kursu)",
      "Deplasman otobÃ¼sÃ¼", "Antrenman sahasÄ±"
    ],
    roles: ["Teknik direktÃ¶r", "Kaleci", "Forvet", "Taraftar", "Hakem", "Spiker", "MasÃ¶r", "Menajer", "Forma satÄ±cÄ±sÄ±"]
  },
  "tatil": {
    name: "Tatil & Deniz", emoji: "ğŸ–ï¸",
    locations: [
      "Her ÅŸey dahil otel", "Sahil kasabasÄ± bar sokaÄŸÄ±",
      "Beach club", "Kamp alanÄ± (Ã§adÄ±r kurma)",
      "Yayla evi", "Tekne turu",
      "YamaÃ§ paraÅŸÃ¼tÃ¼", "KÃ¶y pansiyonu",
      "Apart otel (bayram dolu)", "Havuz baÅŸÄ± animasyon",
      "Plaj ÅŸezlong kavgasÄ±", "Termal otel",
      "KaplÄ±ca", "Tatil kÃ¶yÃ¼ disco",
      "Sahilde kumdan kale", "Ã‡adÄ±r kampÄ± (sivrisinek savaÅŸÄ±)"
    ],
    roles: ["Turist", "AnimatÃ¶r", "Garson", "Kaptan", "Otelci", "Cankurtaran", "Rehber", "Resepsiyonist"]
  },
  "gece": {
    name: "Gece HayatÄ±", emoji: "ğŸŒ™",
    locations: [
      "Meyhane (rakÄ±-balÄ±k)", "Gece kulÃ¼bÃ¼ (dans pisti)",
      "TÃ¼rkÃ¼ bar", "Pavyon", "Teras bar",
      "Sokak partisi", "Karaoke bar",
      "Pub (maÃ§ yayÄ±nÄ±)", "Nargile bar",
      "Festival alanÄ±", "DÃ¼ÄŸÃ¼n sonrasÄ± after party",
      "Gece kulÃ¼bÃ¼nde kuyruk (kapÄ±da tanÄ±dÄ±k arama)"
    ],
    roles: ["Barmen", "DJ", "Garson", "Bouncer", "MÃ¼zisyen", "Patron", "MÃ¼davim", "DansÃ§Ä±"]
  },
  "devlet": {
    name: "Devlet Dairesi", emoji: "ğŸ›ï¸",
    locations: [
      "NÃ¼fus mÃ¼dÃ¼rlÃ¼ÄŸÃ¼", "Noter", "PTT (kargo kuyruÄŸu)",
      "Tapu dairesi", "Vergi dairesi", "Belediye nikah salonu",
      "Emniyet mÃ¼dÃ¼rlÃ¼ÄŸÃ¼ (pasaport)", "Adliye (duruÅŸma salonu)",
      "SGK (emeklilik baÅŸvuru)", "Ä°ÅKUR (iÅŸ baÅŸvurusu)",
      "E-devlet ÅŸifresi alma kuyruÄŸu", "Belediye su abonelik",
      "Trafik tescil", "Hastane randevu kuyruÄŸu (MHRS)"
    ],
    roles: ["Memur", "MÃ¼dÃ¼r", "VatandaÅŸ", "Avukat", "GÃ¼venlik", "Ã‡aycÄ±", "TercÃ¼man", "Stajyer"]
  },
  "nostalji": {
    name: "90'lar & 2000'ler", emoji: "ğŸ“¼",
    locations: [
      "Video kaset dÃ¼kkanÄ±", "Atari salonu",
      "Lunapark (Ã§arpÄ±ÅŸan araba)", "Sokak arasÄ± futbol (taÅŸ kale)",
      "Bakkalda aÃ§ma top", "KomÅŸuda TV izleme (tek TV olan ev)",
      "KasetÃ§alar baÅŸÄ± (karÄ±ÅŸÄ±k kaset)", "Ã‡iklet otomatÄ±",
      "YazlÄ±k sinema", "Mahalle Ã§eÅŸmesi",
      "Telefon kulÃ¼besi", "SaklambaÃ§ (apartman bodrumu)",
      "Ä°nternet kafe (CS 1.6)", "Nokia 3310 yÄ±lan oyunu",
      "Dondurma arabasÄ± melodisi"
    ],
    roles: ["Bakkal amca", "Mahalle abisi", "KapÄ±cÄ±", "Ã‡ocuk", "Anne", "Baba", "KomÅŸu teyze", "PostacÄ±"]
  },
  "ulasim": {
    name: "UlaÅŸÄ±m", emoji: "ğŸšŒ",
    locations: [
      "DolmuÅŸ (son koltuk)", "Vapur iskelesi",
      "MinibÃ¼s (mÃ¼zik aÃ§Ä±k)", "Taksi (taksimetre kavgasÄ±)",
      "ÅehirlerarasÄ± otobÃ¼s (arka koltuk)", "Tren yolculuÄŸu",
      "Tramvay", "Servis (sabah uykusu)",
      "HavalimanÄ± (bagaj bekleme)", "KÃ¶y yolu (stabilize)",
      "Belediye otobÃ¼sÃ¼ (tÄ±klÄ±m tÄ±klÄ±m)", "KÃ¶y minibÃ¼sÃ¼",
      "Otostop Ã§ekme", "Gece otobÃ¼sÃ¼ (muavin Ã§ay servisi)"
    ],
    roles: ["ÅofÃ¶r", "Muavin", "Yolcu", "KondÃ¼ktÃ¶r", "BiletÃ§i", "Kaptan", "Hostes", "Taksici"]
  },
  "aile": {
    name: "Aile & Akraba", emoji: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦",
    locations: [
      "Bayram sabahÄ± el Ã¶pme turu", "Akraba dÃ¼ÄŸÃ¼nÃ¼nde dedikodu masasÄ±",
      "YÄ±lbaÅŸÄ± tombala gecesi", "Ramazan iftar sofrasÄ±",
      "KayÄ±nvalide ziyareti", "Torun sevme seansÄ± (nine-dede)",
      "Aile WhatsApp grubunda tartÄ±ÅŸma", "Miras paylaÅŸÄ±m toplantÄ±sÄ±",
      "Yaz tatili kÃ¶y evi", "GurbetÃ§i dayÄ±nÄ±n geliÅŸi",
      "Ã‡ocuÄŸa isim koyma tartÄ±ÅŸmasÄ±", "Aile bÃ¼yÃ¼ÄŸÃ¼ nasihat seansÄ±",
      "Ramazan sahur hazÄ±rlÄ±ÄŸÄ±", "Arife gÃ¼nÃ¼ mezarlÄ±k ziyareti",
      "KÃ¼Ã§Ã¼k Ã§ocuÄŸa harÃ§lÄ±k verme anÄ±"
    ],
    roles: ["Anne", "Baba", "KayÄ±nvalide", "KayÄ±npeder", "Damat", "Gelin", "Amca", "Teyze", "Kuzen", "Dede", "Nine"]
  },
  "is": {
    name: "Ä°ÅŸ HayatÄ±", emoji: "ğŸ’¼",
    locations: [
      "AÃ§Ä±k ofis (dedikodu kÃ¶ÅŸesi)", "ToplantÄ± odasÄ± (bitmek bilmeyen sunum)",
      "Ã–ÄŸle arasÄ± yemek sipariÅŸi tartÄ±ÅŸmasÄ±", "Patron odasÄ±nda maaÅŸ pazarlÄ±ÄŸÄ±",
      "Ä°ÅŸ gÃ¶rÃ¼ÅŸmesi (ter basan)", "Mutfak (buzdolabÄ±ndan yemek Ã§alÄ±nmasÄ±)",
      "Sigara molasÄ± sohbeti", "Cuma mesai bitiÅŸi (kaÃ§Ä±ÅŸ planÄ±)",
      "Stajyer ilk gÃ¼n", "Ä°stifa mektubu yazma anÄ±",
      "Ofis doÄŸum gÃ¼nÃ¼ kutlamasÄ± (zoraki)", "YazÄ±cÄ± bozuldu (IT Ã§aÄŸÄ±rma)",
      "Excel tablosu ile boÄŸuÅŸma", "Zoom toplantÄ±sÄ± (kamera kapalÄ±)"
    ],
    roles: ["Patron", "MÃ¼dÃ¼r", "Stajyer", "Ä°K uzmanÄ±", "Ã‡aycÄ±", "GÃ¼venlik", "Muhasebeci", "Sekreter", "IT'ci"]
  },
  "saglik": {
    name: "SaÄŸlÄ±k", emoji: "ğŸ¥",
    locations: [
      "Devlet hastanesi bekleme salonu", "Aile hekimi sÄ±rasÄ±",
      "DiÅŸ hekimi koltuÄŸu", "Eczane (ilaÃ§ sorgulama)",
      "Kan alma odasÄ± (iÄŸne korkusu)", "Acil servis gece nÃ¶beti",
      "GÃ¶z doktoru (numara Ã¶lÃ§me)", "Hastane kantini",
      "RÃ¶ntgen bekleme", "Doktora WhatsApp'tan fotoÄŸraf atma",
      "Anne-babanÄ±n ilaÃ§ saati hatÄ±rlatmasÄ±", "Hastane otopark kavgasÄ±"
    ],
    roles: ["Doktor", "HemÅŸire", "Hasta", "EczacÄ±", "Laborant", "Ambulans ÅŸofÃ¶rÃ¼", "RefakatÃ§i", "GÃ¼venlik"]
  }
};

let state = {
  playerCount: 4,
  spyCount: 1,
  selectedCats: new Set(Object.keys(DATA)),
  currentLocation: null,
  currentCategory: null,
  roles: [],
  currentPlayer: 0,
  revealed: false,
  timerSeconds: 480,
  timerRemaining: 480,
  timerInterval: null,
  timerRunning: false
};

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function changePlayerCount(d) {
  state.playerCount = Math.max(3, Math.min(30, state.playerCount + d));
  document.getElementById('playerCount').textContent = state.playerCount;
  if (state.spyCount >= state.playerCount - 1) {
    state.spyCount = Math.max(1, state.playerCount - 2);
    document.getElementById('spyCount').textContent = state.spyCount;
  }
}

function changeSpyCount(d) {
  state.spyCount = Math.max(1, Math.min(state.playerCount - 2, state.spyCount + d));
  document.getElementById('spyCount').textContent = state.spyCount;
}

function goToCategories() {
  renderCategories();
  showScreen('categories');
}

function renderCategories() {
  const grid = document.getElementById('catGrid');
  grid.innerHTML = '';
  for (const [key, cat] of Object.entries(DATA)) {
    const card = document.createElement('div');
    card.className = 'cat-card' + (state.selectedCats.has(key) ? ' selected' : '');
    card.innerHTML = `<div class="emoji">${cat.emoji}</div><div class="name">${cat.name}</div><div class="count">${cat.locations.length} mekan</div>`;
    card.onclick = () => {
      if (state.selectedCats.has(key)) state.selectedCats.delete(key);
      else state.selectedCats.add(key);
      card.classList.toggle('selected');
    };
    grid.appendChild(card);
  }
}

function selectAllCats() {
  state.selectedCats = new Set(Object.keys(DATA));
  renderCategories();
}

function deselectAllCats() {
  state.selectedCats.clear();
  renderCategories();
}

function quickStart() {
  state.selectedCats = new Set(Object.keys(DATA));
  startGame();
}

function startGame() {
  if (state.selectedCats.size === 0) { alert('En az bir kategori seÃ§!'); return; }

  const allLocations = [];
  for (const key of state.selectedCats) {
    for (const loc of DATA[key].locations) {
      allLocations.push({ location: loc, category: key });
    }
  }

  const pick = allLocations[Math.floor(Math.random() * allLocations.length)];
  state.currentLocation = pick.location;
  state.currentCategory = pick.category;

  const catData = DATA[pick.category];
  const availableRoles = [...catData.roles];

  state.roles = [];
  const spyIndices = new Set();
  while (spyIndices.size < state.spyCount) {
    spyIndices.add(Math.floor(Math.random() * state.playerCount));
  }

  for (let i = 0; i < state.playerCount; i++) {
    if (spyIndices.has(i)) {
      state.roles.push({ spy: true });
    } else {
      const role = availableRoles.length > 0
        ? availableRoles.splice(Math.floor(Math.random() * availableRoles.length), 1)[0]
        : catData.roles[Math.floor(Math.random() * catData.roles.length)];
      state.roles.push({ spy: false, role, location: pick.location });
    }
  }

  state.currentPlayer = 0;
  state.revealed = false;
  renderReveal();
  showScreen('reveal');
}

function renderReveal() {
  const area = document.getElementById('revealArea');
  const p = state.currentPlayer;
  const total = state.playerCount;
  const isUnluler = state.currentCategory === 'unluer';

  if (p >= total) {
    area.innerHTML = `
      <div class="role-card normal-card fade-in">
        <div class="role-icon">âœ…</div>
        <div class="role-title">Kartlar DaÄŸÄ±tÄ±ldÄ±</div>
        <div class="role-value">Oyun BaÅŸlasÄ±n!</div>
        <div class="role-sub">${state.spyCount} casus aramÄ±zda...</div>
      </div>
      <button class="btn btn-primary" onclick="goToTimer()" style="max-width:320px">ZamanlayÄ±cÄ±ya GeÃ§</button>
    `;
    document.getElementById('revealSub').textContent = 'Herkes kartÄ±nÄ± gÃ¶rdÃ¼';
    return;
  }

  if (!state.revealed) {
    area.innerHTML = `
      <div class="progress-bar"><div class="fill" style="width:${(p / total) * 100}%"></div></div>
      <div class="role-hidden fade-in" onclick="revealCard()">
        <div class="player-num">Oyuncu ${p + 1}</div>
        <div class="tap-icon pulse">ğŸ‘†</div>
        <p>KartÄ±nÄ± gÃ¶rmek iÃ§in dokun</p>
      </div>
    `;
    document.getElementById('revealSub').textContent = `${p + 1}/${total} - Telefonu Oyuncu ${p + 1}'e ver`;
  }
}

function revealCard() {
  state.revealed = true;
  const area = document.getElementById('revealArea');
  const role = state.roles[state.currentPlayer];
  const isUnluler = state.currentCategory === 'unluer';
  const p = state.currentPlayer;
  const total = state.playerCount;

  if (role.spy) {
    area.innerHTML = `
      <div class="progress-bar"><div class="fill" style="width:${((p + 1) / total) * 100}%"></div></div>
      <div class="role-card spy-card fade-in">
        <div class="role-icon">ğŸ•µï¸</div>
        <div class="role-title">Sen</div>
        <div class="role-value" style="color:var(--accent)">CASUSSUN!</div>
        <div class="role-sub">${isUnluler ? 'Kim olduÄŸunu bul!' : 'MekanÄ± bul!'}</div>
      </div>
      <button class="btn btn-secondary" onclick="nextPlayer()" style="max-width:320px">Gizle & Sonraki</button>
    `;
  } else {
    area.innerHTML = `
      <div class="progress-bar"><div class="fill" style="width:${((p + 1) / total) * 100}%"></div></div>
      <div class="role-card normal-card fade-in">
        <div class="role-icon">${isUnluler ? 'â­' : 'ğŸ“'}</div>
        <div class="role-title">${isUnluler ? 'KiÅŸi' : 'Mekan'}</div>
        <div class="role-value">${role.location}</div>
        <div class="role-sub">RolÃ¼n: ${role.role}</div>
      </div>
      <button class="btn btn-secondary" onclick="nextPlayer()" style="max-width:320px">Gizle & Sonraki</button>
    `;
  }
}

function nextPlayer() {
  state.currentPlayer++;
  state.revealed = false;
  renderReveal();
}

function goToTimer() {
  const isUnluler = state.currentCategory === 'unluer';
  document.getElementById('locationDisplay').textContent = state.currentLocation;
  document.querySelector('#locationHint .label').textContent = isUnluler ? 'KiÅŸi' : 'Mekan / KiÅŸi';
  document.getElementById('locationHint').style.display = 'none';
  resetTimer();
  showScreen('timer');
}

function setTimer(seconds) {
  state.timerSeconds = seconds;
  state.timerRemaining = seconds;
  state.timerRunning = false;
  clearInterval(state.timerInterval);
  document.getElementById('timerToggle').textContent = 'BaÅŸlat';
  updateTimerDisplay();
  document.querySelectorAll('#timerPresets .btn-small').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
}

function toggleTimer() {
  if (state.timerRunning) {
    clearInterval(state.timerInterval);
    state.timerRunning = false;
    document.getElementById('timerToggle').textContent = 'Devam';
  } else {
    state.timerRunning = true;
    document.getElementById('timerToggle').textContent = 'Durdur';
    state.timerInterval = setInterval(() => {
      state.timerRemaining--;
      if (state.timerRemaining <= 0) {
        clearInterval(state.timerInterval);
        state.timerRunning = false;
        state.timerRemaining = 0;
        document.getElementById('timerToggle').textContent = 'Bitti!';
        try { navigator.vibrate(500); } catch(e) {}
      }
      updateTimerDisplay();
    }, 1000);
  }
}

function resetTimer() {
  clearInterval(state.timerInterval);
  state.timerRunning = false;
  state.timerRemaining = state.timerSeconds;
  document.getElementById('timerToggle').textContent = 'BaÅŸlat';
  updateTimerDisplay();
}

function updateTimerDisplay() {
  const m = Math.floor(state.timerRemaining / 60);
  const s = state.timerRemaining % 60;
  const display = document.getElementById('timerDisplay');
  display.textContent = `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
  display.className = 'timer-display';
  if (state.timerRemaining <= 30) display.classList.add('danger');
  else if (state.timerRemaining <= 60) display.classList.add('warning');
}

function showLocations() {
  const grid = document.getElementById('locationListGrid');
  grid.innerHTML = '';
  for (const key of state.selectedCats) {
    const cat = DATA[key];
    const label = document.createElement('div');
    label.className = 'cat-label';
    label.textContent = cat.emoji + ' ' + cat.name;
    grid.appendChild(label);
    for (const loc of cat.locations) {
      const item = document.createElement('div');
      item.className = 'loc-item';
      item.textContent = loc;
      grid.appendChild(item);
    }
  }
  showScreen('locations');
}

function showRules() { showScreen('rules'); }

renderCategories();
</script>
</body>
</html>
